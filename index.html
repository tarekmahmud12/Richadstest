<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RichAds Mini App Ad Integration</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Font: Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
            transition: background-color 0.3s;
        }
        .primary-red {
            background-color: #ef4444; /* Primary logo color (Red) */
        }
        .main-button {
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .main-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Main Container -->
    <div class="w-full max-w-lg bg-white rounded-xl shadow-2xl overflow-hidden p-6 md:p-8">

        <!-- Header and Logo -->
        <header class="text-center mb-8">
            <div class="inline-block p-3 rounded-2xl primary-red mb-4 shadow-lg">
                <!-- Logo Image -->
                <img src="uploaded:1000051217.jpg-eb096009-6945-4f9b-aa1e-5e44a08ae911" alt="RichAds Logo - White Crown on Red" class="w-12 h-12 md:w-16 md:h-16 rounded-lg object-cover">
            </div>
            <h1 class="text-4xl font-extrabold text-gray-900 tracking-tight">
                RichAds Ad Integration
            </h1>
            <p id="headerSubtitle" class="text-gray-500 mt-1">Select your desired Ad Format</p>
        </header>

        <!-- 1. Dashboard View (Button Selection) -->
        <div id="dashboardView"> 
            <div class="mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-lg">
                <p class="font-bold text-blue-800">NOTICE:</p>
                <p class="text-sm text-blue-700">The "Interstitial Banner" uses your custom SDK script. Other buttons use a generic placeholder script (for debugging purposes).</p>
            </div>
            
            <div class="grid grid-cols-1 gap-4">
                
                <!-- Button 1: Push-style -->
                <button onclick="loadFormat('push', 'null', '3767', 'Telegram Push-style Ad')"
                        class="main-button primary-red text-white py-4 px-6 rounded-xl font-semibold text-lg hover:bg-red-600 focus:outline-none focus:ring-4 focus:ring-red-300 transition duration-150">
                    1. Push-style Ad
                </button>
                
                <!-- Button 2: Embedded banner -->
                <button onclick="loadFormat('embedded', '987925', '3767', 'Telegram Embedded Banner')"
                        class="main-button bg-blue-600 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-150">
                   2. Embedded Banner Ad
                </button>

                <!-- Button 3: Interstitial banner (Uses custom, provided SDK) -->
                <button onclick="loadFormat('interstitial_banner', '987925', '3767', 'Telegram Interstitial Banner')"
                        class="main-button bg-green-600 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-300 transition duration-150">
                    3. Interstitial Banner Ad (Custom SDK)
                </button>

                <!-- Button 4: Interstitial video -->
                <button onclick="loadFormat('interstitial_video', '987925', '3767', 'Telegram Interstitial Video')"
                        class="main-button bg-yellow-600 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:bg-yellow-700 focus:outline-none focus:ring-4 focus:ring-yellow-300 transition duration-150">
                    4. Interstitial Video Ad
                </button>

                <!-- Button 5: Playable ads -->
                <button onclick="loadFormat('playable', '987925', '3767', 'Telegram Playable Ad')"
                        class="main-button bg-purple-600 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:bg-purple-700 focus:outline-none focus:ring-4 focus:ring-purple-300 transition duration-150">
                    5. Playable Ad
                </button>
            </div>
        </div>
        
        <!-- 2. Ad Loader View -->
        <div id="adView" class="hidden text-center">
            <h2 id="adFormatTitle" class="text-2xl font-bold text-gray-800 mb-4"></h2>
            
            <div id="loadingIndicator" class="bg-indigo-100 border-l-4 border-indigo-500 text-indigo-700 p-4 rounded-lg" role="alert">
                <p class="font-bold">RichAds SDK is Loading...</p>
                <p class="text-sm mt-1">Injecting your script using the specific method for this format.</p>
                <p class="text-xs mt-2 text-gray-600">Pub ID: <span id="pubIdDisplay"></span>, App ID: <span id="appIdDisplay"></span></p>
            </div>

            <div id="adContainer" class="mt-6 p-4 border-2 border-dashed border-gray-300 rounded-lg min-h-[200px] flex items-center justify-center text-gray-600 bg-gray-50">
                <!-- Demo Content (The actual RichAds ad content will replace this area on a live site) -->
                <div id="demoAd" class="text-center p-6 w-full max-w-md bg-white border border-yellow-400 rounded-lg shadow-md">
                    <p class="text-xl font-bold text-yellow-600 mb-2">Ad Display Placeholder</p>
                    <p class="text-sm text-gray-700 font-semibold">Issue: External ads are blocked in this Preview (iFrame) environment.</p>
                    <div class="mt-3 p-3 bg-yellow-100 rounded-lg">
                        <p class="font-semibold text-yellow-800">This area is ready to load the **<span id="demoFormatName" class="text-red-600 font-extrabold"></span>** ad format.</p>
                        <p class="text-xs mt-1 text-gray-700">The script provided by you has been injected. Please test on your live environment.</p>
                    </div>
                </div>
            </div>

            <button onclick="goBackToDashboard()" 
                    class="mt-6 bg-gray-500 text-white py-2 px-4 rounded-lg font-semibold hover:bg-gray-600 transition duration-150">
                Go Back to Dashboard
            </button>
        </div>

    </div>

    <script>
        // CRITICAL ACTION REQUIRED for OTHER BUTTONS: 
        // Replace this placeholder URL for the *other* four buttons (1, 2, 4, 5).
        const SCRIPT_URL_BASE = "https://ads.richads.com/sdk/richads-tg-sdk.js"; 

        const INTERSTITIAL_SDK_URL = "https://richinfo.co/richpartners/telegram/js/tg-ob.js";

        const dashboardView = document.getElementById('dashboardView');
        const adView = document.getElementById('adView');
        const headerSubtitle = document.getElementById('headerSubtitle');
        const demoAd = document.getElementById('demoAd');

        /**
         * Redirects the user with URL parameters to simulate a page load for a specific format.
         */
        function loadFormat(formatKey, pubId, appId, title) {
            const newUrl = `?format=${formatKey}&pubId=${pubId}&appId=${appId}&title=${encodeURIComponent(title)}`;
            window.location.href = newUrl;
        }

        /**
         * Clears URL parameters to return to the dashboard.
         */
        function goBackToDashboard() {
            window.location.href = window.location.pathname; // Reloads without parameters
        }

        /**
         * Injects the RichAds script based on the format key.
         */
        function injectAdScripts(pubId, appId, format) {
            const loadingIndicator = document.getElementById('loadingIndicator');
            loadingIndicator.innerHTML = '<p class="font-bold text-indigo-700">RichAds SDK is Loading...</p><p class="text-sm mt-1">Injecting your script using the specific method for this format.</p><p class="text-xs mt-2 text-gray-600">Pub ID: ' + pubId + ', App ID: ' + appId + '</p>';


            if (format === 'interstitial_banner') {
                // --- USER'S SPECIFIC SDK IMPLEMENTATION ---
                
                // 1. Inject the main SDK script
                const mainScript = document.createElement('script');
                mainScript.src = INTERSTITIAL_SDK_URL;
                document.head.appendChild(mainScript);

                mainScript.onload = () => {
                    try {
                        // 2. Inject the initialization script provided by the user
                        const initScript = document.createElement('script');
                        initScript.textContent = `
                            window.TelegramAdsController = new TelegramAdsController();
                            window.TelegramAdsController.initialize({
                                pubId: "987925",
                                appId: "3767",
                            });
                            console.log("Custom Interstitial SDK Initialized.");
                        `;
                        document.head.appendChild(initScript);

                        // Success update
                        loadingIndicator.classList.remove('bg-indigo-100', 'border-indigo-500', 'text-indigo-700');
                        loadingIndicator.classList.add('bg-green-100', 'border-green-500', 'text-green-700');
                        loadingIndicator.innerHTML = '<p class="font-bold text-green-700">RichAds SDK Loaded (Custom Interstitial Method).</p><p class="text-sm mt-1">This code uses the specific two-script setup you provided.</p>';
                        document.getElementById('demoAd').classList.remove('hidden');
                        
                    } catch (e) {
                        // Error in TelegramAdsController initialization
                        console.error("Interstitial Initialization error:", e);
                        loadingIndicator.classList.remove('bg-indigo-100', 'border-indigo-500', 'text-indigo-700');
                        loadingIndicator.classList.add('bg-red-100', 'border-red-500', 'text-red-700');
                        loadingIndicator.innerHTML = '<p class="font-bold text-red-700">Custom SDK Initialization Failed.</p><p class="text-sm mt-1">The main script loaded, but the controller failed (SDK issue).</p>';
                        document.getElementById('demoAd').classList.remove('hidden');
                    }
                };

                mainScript.onerror = () => {
                    // Error loading the main SDK script
                    console.error("Main SDK load failed:", INTERSTITIAL_SDK_URL);
                    loadingIndicator.classList.remove('bg-indigo-100', 'border-indigo-500', 'text-indigo-700');
                    loadingIndicator.classList.add('bg-red-100', 'border-red-500', 'text-red-700');
                    loadingIndicator.innerHTML = '<p class="font-bold text-red-700">Custom SDK Script Failed to Load.</p><p class="text-sm mt-1">Check the URL: ' + INTERSTITIAL_SDK_URL + '</p>';
                    document.getElementById('demoAd').classList.remove('hidden');
                };

            } else {
                // --- GENERIC/PLACEHOLDER SDK IMPLEMENTATION (for other buttons) ---
                
                const pubIdParam = (pubId === 'null' || !pubId) ? '' : `&pubId=${pubId}`;
                const finalScriptUrl = `${SCRIPT_URL_BASE}?appId=${appId}${pubIdParam}`;
                
                const adScript = document.createElement('script');
                adScript.src = finalScriptUrl;
                adScript.async = true;

                adScript.onload = () => {
                    console.log(`Generic RichAds SDK loaded successfully from: ${finalScriptUrl}`);
                    loadingIndicator.classList.remove('bg-indigo-100', 'border-indigo-500', 'text-indigo-700');
                    loadingIndicator.classList.add('bg-green-100', 'border-green-500', 'text-green-700');
                    loadingIndicator.innerHTML = '<p class="font-bold text-green-700">Generic RichAds SDK Loaded Successfully.</p><p class="text-sm mt-1">The ad should display in your live Telegram Mini App.</p>';
                    document.getElementById('demoAd').classList.remove('hidden');
                };

                adScript.onerror = (e) => {
                    console.error(`Error loading RichAds SDK from: ${finalScriptUrl}`, e);
                    loadingIndicator.classList.remove('bg-indigo-100', 'border-indigo-500', 'text-indigo-700');
                    loadingIndicator.classList.add('bg-red-100', 'border-red-500', 'text-red-700');
                    loadingIndicator.innerHTML = '<p class="font-bold text-red-700">Generic SDK Load Failed (Placeholder method).</p><p class="text-sm mt-1">Check the URL in SCRIPT_URL_BASE.</p>';
                    document.getElementById('demoAd').classList.remove('hidden');
                };
                
                document.head.appendChild(adScript);
            }
        }

        /**
         * Initializes the application based on URL parameters.
         */
        function initApp() {
            const params = new URLSearchParams(window.location.search);
            const format = params.get('format');
            const pubId = params.get('pubId');
            const appId = params.get('appId');
            const title = params.get('title');

            if (format && pubId && appId && title) {
                // Show Ad View
                dashboardView.classList.add('hidden');
                adView.classList.remove('hidden');
                document.body.style.backgroundColor = '#e0f2fe'; 
                headerSubtitle.textContent = "Ad Loading Status";

                // Update UI elements
                document.getElementById('adFormatTitle').textContent = title;
                document.getElementById('pubIdDisplay').textContent = pubId;
                document.getElementById('appIdDisplay').textContent = appId;
                document.getElementById('demoFormatName').textContent = title; 
                
                // Hide demo ad until the script status is known
                demoAd.classList.add('hidden'); 

                // Inject the RichAds script, passing the format key
                injectAdScripts(pubId, appId, format);

            } else {
                // Show Dashboard View
                adView.classList.add('hidden');
                dashboardView.classList.remove('hidden');
                document.body.style.backgroundColor = '#f3f4f6';
                headerSubtitle.textContent = "Select your desired Ad Format";
            }
        }

        // Initialize the application when the DOM is loaded
        window.onload = initApp;

    </script>

</body>
</html>

